!function(window,undefined){var utils={prepareArgs:function(args,element){args=Array.prototype.slice.call(args);args.unshift(element);return args},getObjKeyByValue:function(obj,value){for(var key in obj){if(obj.hasOwnProperty(key)){if(obj[key]===value)return key}}},prepareReturn:function(type){return window[utils.getObjKeyByValue(types,type)]},retrieve:function(value,fallback){return value===undefined?fallback:value},serialize:function(data){return JSON.stringify(data)},unserialize:function(data){if(data===undefined)return undefined;return JSON.parse(data)}};var _storage=function(){return _storage.get.apply(this,arguments)};var host={storage:function(){return storage.get.apply(storage,arguments)},session:function(){return session.get.apply(session,arguments)}};_storage.set=function(type,key,value){if(key===Object(key)){for(var k in key){if(key.hasOwnProperty(k))type.setItem(k,utils.serialize(key[k]))}}else type.setItem(key,utils.serialize(value));return utils.prepareReturn(type)};_storage.remove=function(type,keys){keys=Array.isArray(keys)?keys:Array.prototype.slice.call(arguments);for(var i=0,l=keys.length;i<l;i++){delete type[keys[i]]}return utils.prepareReturn(type)};_storage.empty=function(type){type.clear();return utils.prepareReturn(type)};_storage.get=function(type,keys,fallback){fallback=fallback||undefined;if(Array.isArray(keys)){var result={};for(var i=0,l=keys.length;i<l;i++){var key=keys[i];result[key]=this.get(type,key,fallback)}return result}else return utils.retrieve(utils.unserialize(type.getItem(keys)),fallback)};_storage.all=function(type){var obj={};for(var i=0,l=type.length;i<l;i++){var key=type.key(i);obj[key]=utils.unserialize(type.getItem(key))}return obj};var methods="set remove empty get all".split(" ");var types={storage:localStorage,session:sessionStorage};for(var i=0,l=methods.length;i<l;i++){var method=methods[i];for(var name in types){if(!types.hasOwnProperty(name))continue;var storeType=types[name];host[name][method]=function(method,storeType){return function(){var args=utils.prepareArgs(arguments,storeType);return _storage[method].apply(_storage,args)}}(method,storeType)}}var loStorage={storage:host.storage,session:host.session};if(typeof define==="function"&&define.amd){define(function(){return loStorage})}else if(typeof exports!=="undefined"){module.exports=loStorage}else{window.storage=host.storage;window.session=host.session}}(window);